# 基于数据流的关键点提取与预测实验设计

## 一、实验目的

已经完成的实验，使用SD Based模型，将卫星图像作为数据特征流，输入到SD Based模型，如下图。

![image-20230814164711332](%E5%9F%BA%E4%BA%8E%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E5%85%B3%E9%94%AE%E7%82%B9%E6%8F%90%E5%8F%96%E4%B8%8E%E9%A2%84%E6%B5%8B%E5%AE%9E%E9%AA%8C%E8%AE%BE%E8%AE%A1.assets/image-20230814164711332.png)

就可以得到如下图的预测到的特征流。

![image-20230814164846280](%E5%9F%BA%E4%BA%8E%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E5%85%B3%E9%94%AE%E7%82%B9%E6%8F%90%E5%8F%96%E4%B8%8E%E9%A2%84%E6%B5%8B%E5%AE%9E%E9%AA%8C%E8%AE%BE%E8%AE%A1.assets/image-20230814164846280.png)

预测得到的特征流不是最终目的，还需要对特征流进行特征提取，特征提取网络使用Unet之类的分割网络。将预测特征流作为输入，输入到特征提取网络，提取目标的关键点，如下图所示。

<img src="%E5%9F%BA%E4%BA%8E%E6%95%B0%E6%8D%AE%E6%B5%81%E7%9A%84%E5%85%B3%E9%94%AE%E7%82%B9%E6%8F%90%E5%8F%96%E4%B8%8E%E9%A2%84%E6%B5%8B%E5%AE%9E%E9%AA%8C%E8%AE%BE%E8%AE%A1.assets/1060.bmp" alt="1060" style="zoom:33%;" />

对每一个特征图都提取关键点，就得到了基于数据流提取的关键点预测结果，相比于传统的关键点预测方法，如卡尔曼滤波等，除了关键点的特征，还提供了除关键点之外的特征可视化信息。**需要证明此方法比于卡尔曼滤波关键点预测算法更加准确。**

## 二、实验设计

### 实验1：十个特征流作为输入，预测下十个特征的位置。

### 实验2：十个特征流作为输入，预测下二十个特征的位置。

实验结论：需要证明，两个方法都需要比传统方法更加准确,而且10-20个特征点的预测值要更加准确。而且卡尔曼滤波在初始预测的时候误差很大（需要收敛），而我们的方法不需要收敛，即使在初始几个特征下误差也很小。

### 三、卡尔曼滤波设计：

图中共有8个关键点，设关键点$i$在图像中的位置、观察矩阵$z_i$为
$$
z_i=[x_i, y_i]^T
$$
单个关键点的状态矩阵为
$$
X_i=[x_{i},y_{i},a_{i},b_{i}]^T=A*[x_{i-1},y_{i-1},a_{i-1},b_{i-1}]^T+\omega_{k-1}
$$


其中$a_i$为关键点坐标x的运动速度，$b_i$为关键点坐标y的运动速度，A矩阵为状态转移矩阵,$\omega_{k-1}$为相关性误差。
$$
A=
\begin{bmatrix}
1&0&\Delta t&0\\
0&1&0&\Delta t\\
0&0&1&0\\
0&0&0&1\\
\end{bmatrix}
$$
从观察矩阵转换到状态矩阵为
$$
z_i=
\begin{bmatrix}
1&0&0&0\\
0&1&0&0
\end{bmatrix}
X_i+V_{k}
$$
其中$V_k$为观测误差。